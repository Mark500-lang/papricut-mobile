"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3870],{3870:(D,m,a)=>{a.r(m),a.d(m,{BookingsPageModule:()=>y});var h,l,u=a(177),P=a(4341),s=a(4488),c=a(8986),f=a(467),_=a(4466),t=a(4438),F=a(4517),b=a(3366),B=a(2404),C=a(8129);function I(n,e){1&n&&t.nrm(0,"ion-spinner",17)}function j(n,e){1&n&&(t.j41(0,"ion-card",18)(1,"ion-card-content"),t.EFF(2," There are no bookings to display! "),t.k0s()())}function R(n,e){if(1&n&&(t.j41(0,"h5",23),t.EFF(1),t.k0s()),2&n){const i=t.XpG().$implicit;t.R7$(),t.JRh(i.client_name)}}function $(n,e){if(1&n&&(t.j41(0,"h5",23),t.EFF(1),t.k0s()),2&n){const i=t.XpG().$implicit;t.R7$(),t.JRh(i.photographer)}}function G(n,e){if(1&n){const i=t.RV6();t.j41(0,"ion-item",4),t.bIt("click",function(r){const d=t.eBV(i).$implicit,p=t.XpG();return t.Njj(p.booking(r,d))}),t.j41(1,"div",19)(2,"div"),t.DNE(3,R,2,1,"h5",20)(4,$,2,1,"h5",20),t.j41(5,"p",21)(6,"strong"),t.EFF(7,"Date:"),t.k0s(),t.EFF(8),t.k0s(),t.j41(9,"p",21)(10,"strong"),t.EFF(11,"Location:"),t.k0s(),t.EFF(12),t.k0s(),t.j41(13,"p",21)(14,"ion-badge"),t.EFF(15),t.k0s()()()(),t.nrm(16,"ion-icon",22),t.k0s()}if(2&n){const i=e.$implicit,o=t.XpG();t.R7$(3),t.Y8G("ngIf","3"==o.rights_group),t.R7$(),t.Y8G("ngIf","4"==o.rights_group),t.R7$(4),t.SpI(" ",i.eventDate,""),t.R7$(4),t.SpI(" ",i.location,""),t.R7$(3),t.JRh(i.bookingProgress)}}class v{constructor(e,i,o,r,d,p,L){this.modalCtrl=e,this.navCtrl=i,this.alertCtrl=o,this.router=r,this.route=d,this.apiService=p,this.networkService=L,this.list=[],this.years=[],this.errorMessage="",this.page=1,this.perPage=0,this.totalData=0,this.totalPage=0,this.nodataavailable=!1,this.apiLoader=!1,this.pageName="bookings",this.status="",this.selectedSegment="",this.rights_group="0",this.year=null,this.city_id=null,this.country_id=null}ngOnInit(){this.rights_group=localStorage.getItem("PapricutRightsGroup")||"",this.route.queryParams.subscribe(e=>{var i;const o=null===(i=this.router.getCurrentNavigation())||void 0===i?void 0:i.extras.state;o&&void 0!==o.status&&(this.selectedSegment=o.status,this.status=o.status,this.loadList())})}segmentChanged(e){this.status=e.detail.value,this.loadList()}ionViewDidEnter(){this.loadList()}doRefresh(e){this.page=1,this.loadList(),e&&e.detail.complete()}loadList(){!0!==navigator.onLine?this.presentAlert("No Internet Connection!","Please put Internet Connection ON and try again"):(this.apiLoader=!0,this.apiService.getBookings(this.page,this.status,this.year,this.city_id,this.country_id).then(e=>{this.apiLoader=!1,this.data=e,this.list=this.data.result.data,this.perPage=this.data.result.per_page,this.totalData=this.data.result.total,this.totalPage=this.data.result.total_pages,this.years=this.data.result.years,0==this.data.result.total?this.nodataavailable=!0:this.nodataavailable=!1},e=>{this.apiLoader=!1,this.errorMessage=e}))}doInfinite(e){this.page++,setTimeout(()=>{this.apiService.getBookings(this.page,this.status,this.year,this.city_id,this.country_id).then(i=>{this.list=this.list.concat(i.result.data),this.perPage=i.result.per_page,this.totalData=i.result.total,this.totalPage=i.result.total_pages,e.target.complete(),this.page>=this.totalPage&&(e.target.disabled=!0)},i=>{console.error("Error while fetching data:",i),e.target.complete()})},100)}presentAlert(e,i){var o=this;return(0,f.A)(function*(){yield(yield o.alertCtrl.create({header:e,message:i,cssClass:"alertButtonCssAuto",buttons:["OK"]})).present()})()}booking(e,i){const o={result:i};this.navCtrl.navigateForward("/booking",{state:o})}filters(){var e=this;return(0,f.A)(function*(){const i=yield e.modalCtrl.create({component:_.u,animated:!0,componentProps:{years:e.years,param2:"value2"}});return i.onDidDismiss().then(o=>{null!==o&&(console.log("Modal data:",o.data),1==o.data.filtered&&(e.page=1,e.country_id=o.data.country_id,e.city_id=o.data.city_id,e.year=o.data.year,e.loadList()))}),yield i.present()})()}}(h=v).\u0275fac=function(e){return new(e||h)(t.rXU(s.W3),t.rXU(F.q9),t.rXU(s.hG),t.rXU(c.Ix),t.rXU(c.nX),t.rXU(b.G),t.rXU(B.A))},h.\u0275cmp=t.VBU({type:h,selectors:[["app-bookings"]],decls:27,vars:5,consts:[["color","primary"],["slot","start"],["mode","md","color","light"],["slot","end"],[3,"click"],["name","filter-outline","color","light",1,"top-right-icon"],[1,"ion-padding"],["mode","ios",1,"custom-segment",3,"ionChange","value"],["value",""],["value","1"],["value","3"],["class","custom-spinner-center",4,"ngIf"],["color","secondary",4,"ngIf"],["slot","fixed",3,"ionRefresh"],["pullingText","Pull to refresh","pullingIcon","arrow-dropdown","refreshingSpinner","circles","refreshingText","..fetching"],[3,"click",4,"ngFor","ngForOf"],[3,"pageName"],[1,"custom-spinner-center"],["color","secondary"],[1,"main-list"],["class","h2-list",4,"ngIf"],[1,"p-list"],["slot","end","name","chevron-forward-outline"],[1,"h2-list"]],template:function(e,i){1&e&&(t.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),t.nrm(3,"ion-back-button",2),t.k0s(),t.j41(4,"ion-title"),t.EFF(5," Bookings "),t.k0s(),t.j41(6,"ion-buttons",3)(7,"ion-button",4),t.bIt("click",function(){return i.filters()}),t.nrm(8,"ion-icon",5),t.k0s()()()(),t.j41(9,"ion-content",6)(10,"ion-segment",7),t.bIt("ionChange",function(r){return i.segmentChanged(r)}),t.j41(11,"ion-segment-button",8)(12,"ion-label"),t.EFF(13,"All"),t.k0s()(),t.j41(14,"ion-segment-button",9)(15,"ion-label"),t.EFF(16,"Active"),t.k0s()(),t.j41(17,"ion-segment-button",10)(18,"ion-label"),t.EFF(19,"Completed"),t.k0s()()(),t.DNE(20,I,1,0,"ion-spinner",11)(21,j,3,0,"ion-card",12),t.j41(22,"ion-refresher",13),t.bIt("ionRefresh",function(r){return i.doRefresh(r)}),t.nrm(23,"ion-refresher-content",14),t.k0s(),t.DNE(24,G,17,5,"ion-item",15),t.k0s(),t.j41(25,"ion-footer"),t.nrm(26,"app-bottomtabs",16),t.k0s()),2&e&&(t.R7$(10),t.Y8G("value",i.status),t.R7$(10),t.Y8G("ngIf",i.apiLoader),t.R7$(),t.Y8G("ngIf",i.nodataavailable),t.R7$(3),t.Y8G("ngForOf",i.list),t.R7$(2),t.Y8G("pageName",i.pageName))},dependencies:[C.J,u.Sq,u.bT,s.In,s.Jm,s.QW,s.b_,s.I9,s.W9,s.M0,s.eU,s.iq,s.uz,s.he,s.To,s.Ki,s.Gp,s.eP,s.w2,s.BC,s.ai,s.Je,s.el]});const E=[{path:"",component:v}];class k{}(l=k).\u0275fac=function(e){return new(e||l)},l.\u0275mod=t.$C({type:l}),l.\u0275inj=t.G2t({imports:[c.iI.forChild(E),c.iI]});var g,T=a(3887);class y{}(g=y).\u0275fac=function(e){return new(e||g)},g.\u0275mod=t.$C({type:g}),g.\u0275inj=t.G2t({imports:[T.G,u.MD,P.YN,s.bv,k]})}}]);